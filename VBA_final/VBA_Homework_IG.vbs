'Type your solution hereSub stock_market_wver()Dim j As Integerj = 1Dim ticker_name As StringDim change_open As DoubleDim percent_change As DoubleDim first_cell_open As DoubleDim volume_total As VariantDim TickV As StringDim TickMinPCh As StringDim TickMaxPCh As StringDim MaxV As VariantDim MinPercCh As DoubleDim MaxPercCh As DoubleDim GrandMaxPercCh As DoubleDim GrandMinPercCh As DoubleDim GrandM_volume_total As VariantDim GrandMTickV As StringDim GrandTickMinPCh As StringDim GrandTickMaxPCh As String        Dim lastrow As LongDim lastrow1 As IntegerDim n As LongDim k As Long'calculating output results: Yearly change, Percent Change, Total Volume StockFor Each ws In Worksheets        table_row = 2        k = 0        first_cell_open = 0        volume_total = 0        change_open = 0        percent_change = 0                lastrow = ws.Cells(Rows.Count, 1).End(xlUp).Row        ws.Cells(1, 10).Value = "ticker"        ws.Cells(1, 11).Value = "volume total"        ws.Cells(1, 12).Value = "Yearly Change"        ws.Cells(1, 13).Value = "Percent Change"                ws.Cells(3, 19).Value = "Max Volume Total"        ws.Cells(4, 19).Value = "Min Percent Change"        ws.Cells(5, 19).Value = "Max Percent Change"            For i = 2 To lastrow        k = k + 1        volume_total = volume_total + ws.Cells(i, 7).Value                        If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                ticker_name = ws.Cells(i, 1).Value                first_cell_open = ws.Cells(i + 1 - k, 3).Value                change_open = ws.Cells(i, 3).Value - first_cell_open                                If first_cell_open <> 0 Then                    percent_change = change_open / first_cell_open * 100                    percent_change = Round(percent_change, 2)                Else                    percent_change = 0                End If                ws.Range("J" & table_row).Value = ticker_name                ws.Range("K" & table_row).Value = volume_total                ws.Range("L" & table_row).Value = change_open                ws.Range("M" & table_row).Value = percent_change                table_row = table_row + 1                change_open = 0                percent_change = 0                volume_total = 0                k = 0                first_cell_open = 0            End If                 Next i                For n = 2 To lastrow            If ws.Cells(n, 12) < 0 Then                ws.Cells(n, 12).Interior.ColorIndex = 3            Else                ws.Cells(n, 12).Interior.ColorIndex = 4            End If        Next n 'looking for Max/ Min values in summary columns    MaxV = ws.Cells(2, 11).Value    TickV = ws.Cells(2, 10).Value        MinPercCh = ws.Cells(2, 13).Value    TickMinPCh = ws.Cells(2, 10).Value        MaxPercCh = ws.Cells(2, 13).Value    TickMaxPCh = ws.Cells(2, 10).Value        For i = 2 To lastrow        If ws.Cells(i + 1, 11).Value > MaxV Then            TickV = ws.Cells(i + 1, 10).Value            MaxV = ws.Cells(i + 1, 11).Value        End If        If ws.Cells(i + 1, 13).Value < MinPercCh Then            MinPercCh = ws.Cells(i + 1, 13).Value            TickMinPCh = ws.Cells(i + 1, 10).Value        End If        If ws.Cells(i + 1, 13).Value > MaxPercCh Then            MaxPercCh = ws.Cells(i + 1, 13).Value            TickMaxPCh = ws.Cells(i + 1, 10).Value        End If                ws.Cells(3, 20).Value = TickV        ws.Cells(4, 20).Value = TickMinPCh        ws.Cells(5, 20).Value = TickMaxPCh                ws.Cells(3, 21).Value = MaxV        ws.Cells(4, 21).Value = MinPercCh        ws.Cells(5, 21).Value = MaxPercCh            Next i            j = j + 1    Next ws'combine Max/Min data into worrksheet ASheets("A").Cells(1, 23).Value = "Multi Year Stock Data"Sheets("A").Cells(2, 23).Value = "Ticker"Sheets("A").Cells(2, 24).Value = "Max Volume Total"Sheets("A").Cells(2, 25).Value = "Ticker"Sheets("A").Cells(2, 26).Value = "Min Percent Change"Sheets("A").Cells(2, 27).Value = "Ticker"Sheets("A").Cells(2, 28).Value = "Max Percent Change"j = 3    For Each ws In Worksheets        Sheets("A").Cells(j, 23).Value = ws.Cells(3, 20).Value        Sheets("A").Cells(j, 24).Value = ws.Cells(3, 21).Value        Sheets("A").Cells(j, 25).Value = ws.Cells(4, 20).Value        Sheets("A").Cells(j, 26).Value = ws.Cells(4, 21).Value        Sheets("A").Cells(j, 27).Value = ws.Cells(5, 20).Value        Sheets("A").Cells(j, 28).Value = ws.Cells(5, 21).Value        j = j + 1    Next ws'Formating "M" column to 0.00%For Each ws In Worksheets            For i = 2 To lastrow            ws.Range("M" & i).Value = ws.Range("M" & i).Value / 100            ws.Range("M" & i).NumberFormat = "0.00%"                    Next iNext ws'looking for Max/Min values in Multi Year Stock Data, "A" worksheetlastrow1 = j + 2    GrandM_volume_total = Sheets("A").Cells(3, 24).Value    GrandMTickV = Sheets("A").Cells(3, 23).Value        GrandMinPercCh = Sheets("A").Cells(3, 26).Value    GrandTickMinPCh = Sheets("A").Cells(3, 25).Value        GrandMaxPercCh = Sheets("A").Cells(3, 28).Value    GrandTickMaxPCh = Sheets("A").Cells(3, 27).Value    For i = 3 To lastrow1                If Sheets("A").Cells(i + 1, 24).Value > GrandM_volume_total Then            GrandMTickV = Sheets("A").Cells(i + 1, 23).Value            GrandM_volume_total = Sheets("A").Cells(i + 1, 24).Value        End If                 If Sheets("A").Cells(i + 1, 26).Value < GrandMinPercCh Then            GrandTickMinPCh = Sheets("A").Cells(i + 1, 25).Value            GrandMinPercCh = Sheets("A").Cells(i + 1, 26).Value        End If                If Sheets("A").Cells(i + 1, 28).Value > GrandMaxPercCh Then            GrandTickMaxPCh = Sheets("A").Cells(i + 1, 27).Value            GrandMaxPercCh = Sheets("A").Cells(i + 1, 28).Value        End If                Sheets("A").Cells(3, 15).Value = "Grand Max Volume"        Sheets("A").Cells(4, 15).Value = "Greatest % Decrease"        Sheets("A").Cells(5, 15).Value = "Greatest % Increase"                Sheets("A").Cells(3, 16).Value = GrandMTickV        Sheets("A").Cells(4, 16).Value = GrandTickMinPCh        Sheets("A").Cells(5, 16).Value = GrandTickMaxPCh                Sheets("A").Cells(3, 17).Value = GrandM_volume_total        Sheets("A").Cells(4, 17).Value = GrandMinPercCh        Sheets("A").Cells(5, 17).Value = GrandMaxPercCh            Next i 'MsgBox ("Completed analysis")End Sub